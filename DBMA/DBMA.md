# 双分支多注意机制网络用于高光谱图像分类 #
## 摘要 ##
- 提出了一种双分支多注意机制网络（DBMA）用于HSI分类。该网络有两个分支分别提取光谱特征和空间特征，减少了两类特征之间的干扰。此外，针对这两个分支的不同特征，分别在这两个分支中应用了两种注意机制，以保证提取出更具区分性的光谱和空间特征。然后对提取的特征进行融合以进行分类。
## 1.引言 ##
### 1.1. Motivation ###
- 光谱-空间残差网络（SSRN），包含光谱残差块和空间残差块依次提取光谱特征和空间特征。基于SSRN和DenseNet提出了一种快速密集连接的谱-空间卷积网络（FDSSC）用于HSI分类，在减少训练时间的同时取得了更好的性能。这两种框架首先提取光谱特征，然后提取空间特征。在提取空间特征的过程中，由于光谱特征和空间特征处于不同的域，提取的光谱特征可能会被破坏。
-  提出了一种基于光谱方向注意机制的三维CNN网络（MSDN-SA），它将频谱方向注意机制应用于密集连接的三维卷积网络中。然而，它只考虑了谱方向的注意，而没有考虑空间方向的注意
- 卷积块注意模块（CBAM），该模块依次在网络中应用信道注意机制和空间注意机制，自适应地细化特征映射，提高了分类性能。
- 在CBAM的启发下，为了解决SSRN和FDSSC的问题，我们提出了双分支多注意机制网络用于HSI分类。该框架由两个平行的分支组成，即谱分支和空间分支。我们分别从空间和频谱两个方面对空间分支注意进行提取。在两个分支提取出相应的特征后，通过级联运算对其进行融合，得到光谱空间特征。最后加入softmax分类器得到最后的分类结果。
### 1.2. Contribution ### 
- 该网络有两个分支分别提取光谱特征和空间特征，减少了两类特征之间的干扰。对提取的光谱特征和空间特征进行融合分类。
- 同时应用了通道注意和空间注意。信道注意的目的是强调信息的频谱特征，同时抑制不太有用的频谱特征，而空间注意力的目标是集中在输入块中信息量最大的区域。
- 与最近提出的其他方法相比，该网络具有最好的分类精度。此外，我们提出的网络的训练时间和测试时间也小于两种比较的深度学习算法，这表明了我们的方法的优越性
## 2.相关工作 ##
### 2.1 Cube-Based HSI Classification Framework Traditional ###
- 提取三维立方体作为网络的输入。与直接使用像素作为输入训练网络进行分类的基于像素的体系结构不同，基于立方体的框架使用HSI的三维结构进行分类。使用基于cube的框架的原因是空间信息对于分类也很重要
### 2.2 Residual Connection and Densely Connection Residual ###
- (1)
- (2)Hl（·）由批标准化（BN）、激活层和卷积层组成。
### 2.3 FDSSC ###
- 基于残差网络，提出了一种包含光谱残差块和空间残差块的光谱-空间残差网络（SSRN），依次提取光谱特征和空间特征。受SSRN和DenseNet的启发，提出了HSI分类的FDDSC网络，在减少训练时间的同时获得了更好的性能
- Figure 2.FDSSC 框架。  
### 2.4 注意机制 ###
- 注意机制可以集中在信息量最大的部分，减少其他区域的权重，这与人眼的注意机制相似。在CBAM[38]中，网络有两个注意模块，即通道注意模块和空间注意模块，分别关注信息通道和信息区域。
#### 2.4.1 通道注意模块 ####
#### 2.4.2 空间注意模块 ####
## 3.方法 ##
- FDSSC在HSI分类中取得了很高的性能，但它首先提取光谱特征，然后提取空间特征。这意味着在提取空间特征的过程中，由于两类特征位于不同的域中，可能会影响首先提取的光谱特征。
- Figure 5 训练过程，将样本分成3组，即训练集Xtrain、验证集Xval和测试集Xtest。训练集用于多个epochs的训练模型，验证集用于评估分类精度，并提取分类精度最高的网络。最后，利用测试集对训练后的模型进行测试，验证了该方法的有效性。如图5所示，我们的网络有两个分支，即信道注意的频谱分支和空间注意的空间分支。
### 3.1 具有通道注意的光谱分支 ###
- 输入斑块大小为7×7×200。频谱分支由密集谱块和信道注意块组成。首先采用核尺寸为1×1×7的三维卷积算法。在第一个卷积运算中，我们使用“有效”填充方法，步长设置为（1,1,2），这在一定程度上减少了频谱通道的数量。经过第一层卷积后，得到了（7×7×97，24）形状的特征图。然后，利用由3个卷积层和批量归一化层组成的稠密谱块提取光谱特征。在稠密谱块中，由于级联的存在，我们将步长设置为（1,1,1），以保持特征映射的大小。经过密集谱块后，得到了尺寸为（7×7×1，60）的光谱特征。然而，60个频道的重要性不同。为了聚焦哪个是重要的并获得更具区分性的光谱特征，如第2.4.1节所示，应用信道注意块。在信道注意阻塞后，重要信道被突出，而不太重要的信道被抑制。最后利用全局平均池层得到1×60的光谱特征。光谱分支各层的详细信息见表1。
### 3.2 具有空间注意的空间分支 ###
- 空间分支由密集空间块和空间注意块组成。首先，采用核尺寸为1×1×200的三维卷积来减少光谱通道数。经过第一层卷积后，得到（7×7×1，24）形状的特征图。光谱通道的数目从200个减少到1个，这将减少训练参数的数量并防止过度拟合。然后采用3层卷积层和批量归一化层相结合的方法提取空间特征。经过密集的空间块后，得到了尺寸为（7×7×1，60）的空间特征。密集空间块的目的是提取空间特征，但输入面片不同位置的重要性不同。为了关注“where”是一个信息部分，并获得更多的空间特征，使用了第2.4.2节中的空间注意块。空间注意块后，重点区域的特征将被突出，而不重要区域的特征将被抑制。然后利用全局平均池层得到1×60的空间特征。空间分支层的详细信息如表2所示。

