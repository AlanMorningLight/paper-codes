# 基于上下文感知动态图卷积网络的高光谱图像分类
## 摘要
## 引言 
## PROPOSED METHOD
### A. GCN
- (1) 向图的形式化定义为G=（V，E），V和E分别表示节点集和边集。符号A表示G的邻接矩阵，表示每对节点之间存在一条边，其（i，j）第个元素可计算为(1).γ被设置为0.2,xi和xj代表两个图节点，N(x j )是xj的领域集合。
- (2)图的谱滤波，可以表示为在Fourier domain通过gθ = diag(θ)对信号x滤波。为了对G进行节点嵌入。U是由归一化图拉普拉斯L的特征向量组成的矩阵。Λ一个包含L特征值的对角矩阵。D是度矩阵。I是单位矩阵。
- (3)通过切比雪夫多项式Tk（x）的截断展开逼近gθ（λ），达到Kth阶，为了减少方程（2）中特征向量分解的计算消耗。θ? 是切比雪夫系数Λ的一个向量，λmax是L的最大特征值
- (4)滤波器gθ对信号x的卷积，切比雪夫多项式定义为Tk（x）=2xTk−1（x）−Tk−2（x），T0（x）=1，T1（x）=x。L表示标度拉普拉斯矩阵。这个表达式是关于拉普拉斯（即K-局部化）的第K阶多项式。也就是说，过滤只依赖于距离中心节点最多K步的节点。
- (5)利用线性公式，Kipf和Welling[31]进一步逼近λmax≈2，因为神经网络参数可以在训练过程中适应这种尺度变化。因此，式（4）可简化为（5）.θ0和θ1是两个自由参数.
- (6)减少参数的数量有利于解决过拟合，公式（5）变为（6）
- (7)GCN模型的卷积操作。H(l)是第l层的输出，σ(·) 代表激活函数，如本文中的softplus function 。W(l)可训练的权重矩阵。
### B. Pixel-to-Region Assignment
- 虽然GCN能够捕捉图像像素之间的上下文关系，但像素级图形卷积的接受域通常是有限的[23]。为了有效地描述像素之间的长距离关系，我们打算超越常规的二维图像网格，并对区域之间的上下文关系进行编码，因为图像区域之间的依赖比像素级卷积捕获的依赖要长得多[23]。其主要思想是学习像素到区域分配，将具有相似特征的像素划分为相干区域，以捕捉原始二维空间中原始区域之间的上下文关系。
- （8）soft assignment matrix P .将原始HSI转换成区域图，这个过程称为图投影。具体地说，网络将学习一个以V∈Rd×c参数化的软分配矩阵来分配每个像素的光谱维数，c是像素zi∈Rd到其相邻区域的个数，其中d表示图像区域，V的每列vi∈Rd对应于一个区域的锚定点。n是像素个数，?N(zi ) 是连接像素zi相邻区域像素集。元素Pij定义了像素zi到vi的软分配。
- （9）区域特征xj可以通过学习得到的像素到区域分配编码得到。通过学习每个区域的特征，可以减少不准确的预计算区域特征的负面影响。
- 在某些极端情况下，大多数甚至全部图像像素可能被分配到单个区域，因此仍然存在优化挑战。这可能是因为图像区域V的锚点矩阵初始化不当，导致赋值矩阵P不适定，而且分配不平衡会导致不良的图结构，从而不能充分利用上下文关系。为了解决这个问题，我们不需要随机初始化V，而是考虑空间信息，利用分割技术初始化V。具体来说，我们采用了广泛应用于图像分割的简单线性迭代聚类（SLIC）算法[25]来获得初始区域。在此，将利用对应区域中涉及的像素的平均光谱签名来初始化每个vi，并且可以通过使用梯度下降进一步更新矩阵V。
- 图2。在我们的CAD-GCN模型中使用的软像素到区域分配的说明。每个初始化的图像区域被黄线包围，蓝色箭头表示关于像素zi到其相邻区域的分配。利用学习到的区域特征，使用（1）可以自然地获得相应的区域图。之后，区域特征X将通过执行图卷积[18]重新计算，该卷积沿着边缘聚集信息。此外，通过连续的图卷积，可以捕捉到远离原始二维空间的区域之间的长程依赖关系
### C. Dynamic Graph Refinement
- （10）广义马氏距离.图卷积的性能很大程度上取决于预先定义的图的质量，该图编码了图节点之间的相似性和连接关系。然而，广泛用于描述节点相似性的欧几里德距离[例如，在（1）]中，可能不是图结构数据的良好度量[19]。为了解决这个缺点，我们打算学习一种改进的距离度量。具体地说，我们构造了一个对称的半正定矩阵M=WdW？d，Wd是一个可训练的权重矩阵。
- 邻接矩阵可以写成用马氏距离表示的形式。
- （12）为（11）重写。由于图的表示随着图的卷积层而更新，学习单个矩阵M不足以精确测量所有层的节点相似性。因此，我们自适应地学习第l层使用的邻接矩阵A（l）的对称半正定参数矩阵M（l），以获得改进的节点相似度。
- 在图的构造过程中，可能会合并不同类别的区域之间的连接，这将导致类间特征信息的聚集，进而降低图卷积结果的可分辨性。为了克服这一不足，我们建议使用边缘过滤器，其目的是通过减少图中不需要的类间边缘来细化上下文关系。由于类内示例通常比类内示例更相似，因此认为值相对较小的元素A（l）ij比值大的A（l）ij更可能表示类间关系。因此，我们对每个图卷积层使用一个阈值β（l）来过滤类间关系，减少类间特征聚合的不利影响。
- (13) 边缘滤波器F(·)
-（14）有了边缘滤波器，图H（l）在实践中，限制参数的数量有助于解决过度拟合的问题[18]，因此，当我们为所有层设置β（l）=β时，可以重新计算卷积层
### D. Region-to-Pixel Assignment 
- 在进行区域级的动态图卷积后，需要将新的区域特征（即学习的图表示）H（L）重新投影到具有像素网格的二维图像中，这一过程称为图重投影。具体地说，区域到像素的分配是通过基于软分配矩阵P（即PH（L）的像素特征线性插值来完成的，其中L表示图形卷积层的数目。需要注意的是，所有重投影像素将具有不同的特征表示，即使其中一些被分配到相同的区域。因此，可以很好地保存HSI的上下文细节。
- （15）CAD-GCN 输出
- （16）交叉熵损失函数，其中C是类的数目，yG表示与标记像素对应的索引集，Y表示标签矩阵。在此，如果像素zi属于第j类，则我们让Yij为1，否则为0。
- 算法1

##  EXPERIMENTAL RESULTS
